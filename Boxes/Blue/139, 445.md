
22 has a possibility of ETERNALBLUE (MS17-010): https://www.exploit-db.com/exploits/42031
— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — 
### metasploit smb_version

msf auxiliary(scanner/smb/smb_version) > run
/usr/share/metasploit-framework/vendor/bundle/ruby/3.3.0/gems/recog-3.1.21/lib/recog/fingerprint/regexp_factory.rb:34: warning: nested repeat operator '+' and '?' was replaced with '*' in regular expression
[*] 10.0.2.4:445          - SMB Detected (versions:1, 2) (preferred dialect:SMB 2.1) (signatures:optional) (uptime:26m 13s) (guid:{bb59edb5-0d5a-4ce5-95fc-a1618ceaca1e}) (authentication domain:WIN-845Q99OO4PP)
[+] 10.0.2.4:445          -   Host is running Windows 7  Ultimate  SP1  (build:7601)
[*] 10.0.2.4              - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — 

### Anonymous login attempt

┌──(kali㉿kali)-[~]
└─$ smbclient -L \\\\10.0.2.4\\    
Password for [WORKGROUP\kali]:

		Sharename       Type      Comment
		---------       ----      -------
		ADMIN$          Disk      Remote Admin
		C$              Disk      Default share
		IPC$            IPC       Remote IPC
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.0.2.4 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available

— — — — — — — — — — — — — — — — — — —

┌──(kali㉿kali)-[~]
└─$ smbclient -L \\\\10.0.2.4\\IPC$
Password for [WORKGROUP\kali]:

		Sharename       Type      Comment
		---------       ----      -------
		ADMIN$          Disk      Remote Admin
		C$              Disk      Default share
		IPC$            IPC       Remote IPC
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.0.2.4 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
